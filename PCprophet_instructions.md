## PCprophet (command line version)

In the PCprophet package, all parameters can be configured either via the ‘ProphetConfig.conf’ file or via by running PCprophet using the command. When running the PCprophet, the parameters indicated in the command will be written into the ‘ProphetConfig.conf’ file. Generally, four types of features are needed:


### Parameter setup


#### Global parameters:
Parameter	Note	Default value
-Input	The input foldera	./Input/
-Output	The output folder	./Output/
-sid	Sample identifier fileb	./sample_ids.txt
-cal	Calibration file (no headers)	./cal.txt

aFor the format of the input folder, please refer to the ./IN/ folder for example.
bThe format of a sample identifier file has been provided in the package. It mainly stores the sample/condition information of the experimental design. Please follow the format in the file for your own experiments.

#### Pre-processing parameters:
Parameter	Note	Default value
-max_hypothesis	The max number of proteins per hypothesis	50
-all_fract	The number of fractions to use [1, X]. Use 'all' for using all fractions	all
-is_ppi	Is the provided database a PPI (protein-protein interaction) or a complex database (False/True)?	False
-merge	PCprophet generates either data-driven hypothesis or database-based hypothesis. Choose ‘all’ for using data-driven+database based hypothesis generation and ‘reference’ to get potential complexes from the database. If ‘reference’ is chosen, the parameter ‘-max_hypothesis’ will not be functional.	all

#### Post-processing parameters:
Parameter	Note	Default value
-collapse_mode	Mode for collapsing hypothesis to common complexes ['GO', 'CAL', 'SUPER', 'NONE'].
‘GO’: max GO scores per branch;
‘CAL’: closer to extrapolated MW;
‘SUPER’ bigger subset;
‘NONE’: no collapsing.	GO
-fdr	The false discovery rate for hypothesis 0>FDR>1. 0.5 is recommended for conservative searches. This is strictly dependent on the database used (a CORUM FDR of 75% correspond to a STRING/ppi FDR of < 20%)	0.75

#### Differential analysis parameters:
Parameter	Note	Default value
-score_missing	how much should be missing protein across conditions be scored?	0.5

---
#### Writing the experimental information
The file ‘sample_ids.txt’ stores the experimental information. An example for the provided testing datasets has been provided:

There are six columns in this file, namely Sample, cond (i.e. condition), group, short_id, repl (i.e. number of replicates), and fr (i.e. number of fractions). In the ‘Sample’ column, please make sure that the content is identical with the testing file name (without the file extension). In the ‘cond’ column, if you have multiple conditions, please label them exactly as ‘Ctrl’, ‘Treat1’, and ‘Treat2’ etc. Failure to do so will cause problems when running PCprophet.

(3) Running PCprophet
PCprophet can be run using the following command (the other parameters have been set in the ‘ProphetConfig.conf’ file and the output folder is set by default):
>python3 main.py -Input ./IN/ -db ./20190513_CORUMcoreComplexes.txt -sid sample_ids.txt

While running in the cluster, please load the needed modules first (using Euler as an example and the output folder is set by default):


#Now load modules
>module load new gcc/4.8.2 python/3.4.3
>module load java

#Now run PCprophet
>bsub -W 48:00 -R "rusage[mem=12288]" python3 main.py -Input ./IN/
-db ./ 20190513_CORUMcoreComplexes.txt -sid sample_ids.txt

We suggest when submitting on the cluster to take in account 24 hours for < 6 samples >24 otherwise. A single run will take approximately 4 hrs locally and 2 hrs on the cluster with default parameter.

----

### Interpreting prediction results
There will be two folders generated by the PCprophet, including the ‘tmp’ folder and the user designated ‘Output’ folder. The ‘tmp’ folder stores all the intermediate files for PCprophet to process and therefore can be used for debugging and validation. The ‘tmp’ folder can be safely deleted after PCprophet finishes all the prediction and analysis. The ‘Output’ folder, on the other hand, harboured all the output files, results and plots generated by PCprophet. A basic structure of the ‘Output’ folder is described in the following figure:

a.	ComplexReport.txt: this file contains all the predicted results, including positive and negative complexes. For positive predictions, we also mapped them to the database provided with the -db parameter to see if they have been documented. If they have been documented, we label them as ‘Reported’; otherwise, they are labelled as ‘Novel’.
b.	ConditionAlignement.pdf: Profile plot of common complexes across all the provided experiments used to realign the data.
c.	FalseDiscoveryRate.pdf: an FDR plot where the positive hypotheses are filtered to control for false discovery rate using the positive complexes database provided. If not provided a fixed threshold of 0.5 is used.
d.	PPIReport.txt: Protein-protein interaction network generated from positive complexes. Suitable as input for network visualization tools such as Cytoscape.
e.	RecallDatabase.pdf: % of positive predicted complexes on the total size of the database provided.
f.	DifferentialComplexReport.txt: Complex-level differential analysis, where complexes are ranked based on the average difference between their protein co-elution profile.
g.	DifferentialProteinReport.txt: Protein-level differential analysis, where the average profile difference between each condition is reported.
h.	Differential: Delta plot of intensity between every condition and control. A flat line represents no difference between control and condition. A positive peak represents an increase in the control; while a negative peak represents an increase in the condition (right Y axis).


i.	The folder containing protein complex co-elution profile plots: Based on the number of conditions and the number of replicates, the co-elution profiles of both predicted positive and negative complexes are illustrated here in this folder. For example, in the following figure, (A) Predicted negative complex but documented in the CORUM database; (B) Predicted novel complex; and (C) Predicted positive complex and documented in the CORUM database.


### Contact
Please refer to [README.md](https://github.com/fossatiA/PCprophet/blob/master/README.md) for how to contact us
