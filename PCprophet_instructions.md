## PCprophet (command line version)

In the PCprophet package, all parameters can be configured either via the ‘ProphetConfig.conf’ file or via by running PCprophet using the command. When running the PCprophet, the parameters indicated in the command will be written into the ‘ProphetConfig.conf’ file. Generally, four types of features are needed:


### Parameter setup


##### Global parameters:

```
-Output The output folder
-sid  Sample identifier file
-cal  Calibration file (no headers)
-mw_uniprot Gene names to molecular mass

```

##### Pre-processing parameters:

```
-all_fract  The number of fractions to use [1, X].
-is_ppi Is the provided database a PPI network or a complex database
-merge  Choose ‘all’ for using data-driven+database based hypothesis generation and ‘reference’ use only database derived complexes

```


##### Post-processing parameters:

```
-co Mode for collapsing hypothesis to common complexes
-fdr  False discovery rate for hypothesis 0 > FDR > 1

```



##### Differential analysis parameters:

```
-score_missing  Score for missing proteins

```

All of the above parameters have the following default settings


| Parameter      | Default           |Possible                              |
| :--------------| :-----------------|:-------------------------------------|
| -Output        | './Output'        |any                                   |
| -sid           | './sample_ids.txt'|any                                   |
| -cal           | None              |any                                   |
| -mw_uniprot    | None              |any                                   |
| -all_fract     | 'all'             |[1>x>number of fractions, 'all']      |
| -is_ppi        | 'False'           |[True, False]                         |
| -merge         | 'all'             |['all', 'reference']                  |
| -co            | 'GO'              |['GO', 'SUPER', 'CAL', 'eCAL', 'NONE']|
| -fdr           | 0.75              |0>x>1                                 |
| -score_missing | 0.5               |0>x>1                                 |


---
### Writing the experimental information file
The file ‘sample_ids.txt’ stores the experimental information and needs to contain the following headers

| Sample     | cond      |group|short_id|repl|fr|
| :----------| :---------| :---|:-------|:---|:-|

- __Sample__ full path of the file intended to be processed
- __cond__ condition name
- __group__ group number (integer, needs to be 1 for control)
- __short_id__ alternative id
- __repl__ replicate number within the contiions
- __fr__ number of fractions per file


> **Note:**  In the ‘Sample’ column, please make sure that the content is identical with the testing file name (with the file extension). In the ‘cond’ column, if you have multiple conditions, please label them exactly as ‘Ctrl’, ‘Treat1’, and ‘Treat2’ etc. Failure to do so will cause problems when running PCprophet.

Here is an example of a complete table with two conditions and three replicates

| Sample     | cond      |group|short_id|repl|fr|
| :----------| :----- |:-----|:-----|:-----|:-----|
| ./Input/c1r1.txt     | Ctrl      |1|ipsc_2i_1|1|65|
| ./Input/c1r2.txt     | Ctrl      |1|ipsc_2i_2|2|64|
| ./Input/c1r3.txt     | Ctrl      |1|ipsc_2i_3|3|65|
| ./Input/c2r1.txt     | Treat1      |2|ipsc_ra_1|1|65|
| ./Input/c2r2.txt     | Treat1      |2|ipsc_ra_2|2|65|
| ./Input/c2r3.txt     | Treat1      |2|ipsc_ra_3|3|65|




> **Note:**  __Differential analysis will be performed *automatically* if the sample_ids.txt file contains more than one group__



---
### Running PCprophet
PCprophet can be using all default settings with


```
python3 main.py
```

Parameters can be individually set, for example using an interaction network instead of a complex database

```
python3 main.py -db myppi.txt -is_ppi True
```



----

### Interpreting prediction results
There will be two folders generated by the PCprophet, including the ‘tmp’ folder and the user designated ‘Output’ folder. The ‘tmp’ folder stores all the intermediate files for PCprophet to process and therefore can be used for debugging and validation. The ‘tmp’ folder can be safely deleted after PCprophet finishes all the prediction and analysis. The ‘Output’ folder, on the other hand, harboured all the output files, results and plots generated by PCprophet.

In the output folder the following text files are present:

- __ComplexReport.txt__: All the predicted results, including positive and negative complexes. For positive predictions, we also mapped them to the database provided with the -db parameter to see if they have been documented. If they have been documented, we label them as ‘Reported’; otherwise, they are labelled as ‘Novel’.
- __PPIReport.txt__: Protein-protein interaction network generated from positive complexes. Suitable as input for network visualization tools such as Cytoscape.

In case differential analysis was performed two additional text files and one folder are going to be present

- __DifferentialComplexReport.txt__: Complex-level differential analysis, where complexes are ranked based on the average difference between their protein co-elution profile.
- __DifferentialProteinReport.txt__: Protein-level differential analysis, where the average profile difference between each condition is reported.


- __Differential__: Differential delta plot of intensity between every condition and control. A flat line represents no difference between control and condition. A positive peak represents an increase in the control; while a negative peak represents an increase in the condition (right Y axis).


PCprophet generates the following QC plots

- __ConditionAlignement.pdf__: Profile plot of common complexes across all the provided experiments used to realign the data.
- __FalseDiscoveryRate.pdf__: an FDR plot where the positive hypotheses are filtered to control for false discovery rate using the positive complexes database provided. If not provided a fixed threshold of 0.5 is used.

- __RecallDatabase.pdf__: % of positive predicted complexes on the total size of the database provided.

One folder for each __short_id__ will be generated. Within that folder all the positive and negative complexes from the database  are plotted together with the novel positive complexes identified by PCprophet

### FAQ

TODO


### Contact
Please refer to [README.md](https://github.com/fossatiA/PCprophet/blob/master/README.md) for how to contact us
